<!DOCTYPE html>
<html>
  <head> </head>
  <body>
    <h1>Weekly Meal Planner</h1>
    <div class="container">
      <div class="row"><input class="recipe1" type="text" placeholder="Recipe 1" /></div>
      <div class="row"><input class="recipe2" type="text" placeholder="Recipe 2" /></div>
      <div class="row"><input class="recipe3" type="text" placeholder="Recipe 3" /></div>
      <div class="row"><input class="recipe4" type="text" placeholder="Recipe 4" /></div>
      <div class="row"><input class="recipe5" type="text" placeholder="Recipe 5" /></div>
      
      <button type="submit" onClick="submitMeals()">Submit Recipes</button>
    </div>

    <div class="container"><ul id="shoppingList"></ul></div>
    <div class="container"><div id="allRecipes"></div></div>

    <script>
      function newEl(type, attrs = {}) {
        const el = document.createElement(type);
        for (let attr in attrs) {
          const value = attrs[attr];
          if (attr == "innerText") el.innertText = value;
          else el.setAttribute(attr, vlue);
        }
        return el;
      }

      // Display shopping list in UI 
      function showShoppingList(ingredients) {
        const shopListUl = document.getElementById("shoppingList");
      
        ingredients.forEach(ing => {
          const ingredientLi = document.createElement('li');
          ing.unit == undefined ? ingredientLi.innerText = ing.value + " " + ing.key : ingredientLi.innerText = ing.value + " " + ing.unit + " " + ing.key;
          shopListUl.append(ingredientLi);
        });
      }

      function showAllOptions(recipes) {
        const allRecipes = document.getElementById("allRecipes");

        recipes.forEach(recipe => {
          const recipeList = document.createElement('p');
          recipeList.innerText = recipe.recipeName + " - " + recipe.servings;
          allRecipes.append(recipeList);
        })

      }

      async function submitMeals() {
        let urls = [];
        const url1 = {url: document.querySelector(".recipe1").value}
        const url2 = {url: document.querySelector(".recipe2").value}
        const url3 = {url: document.querySelector(".recipe3").value}
        const url4 = {url: document.querySelector(".recipe4").value}
        const url5 = {url: document.querySelector(".recipe5").value}

        urls.push(url1, url2, url3, url4, url5);
        
        // Get scraped recipe data from recipe using server api
        jsonS = fetch("http://localhost:3000/recipe", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ urls }),
        })
          .then(response => response.json())
          .then(response => {
            showAllOptions(response.recipes);
            showShoppingList(response.ingredients); 
          });
      }
    </script>
    <style></style>
  </body>
</html>
